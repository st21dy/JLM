<center>

<section id="article">

<div class="container">
<div class="row">
  
<div class="col-md-4">
  <%= attachment_image_tag @user, :icon, :fill, 30, 30, format: 'jpeg', fallback: "no_image.jpg", class:"icon" %>
  <%= link_to @user.name, user_path(@user.id) %>
  <!--投稿者の詳細ページへのリンク-->
</div>

<div class="img">
  <% if @article.video? %>
     <% type = file_type(@article.video.url)%>
     <% if type == 'image' %>
         <%= image_tag @article.video.url, :size => "300x300" %>
     <% elsif type == 'video' %>
         <%= video_tag @article.video.url, autoplay: true, muted: true, controls: true, :size => "300x300" %>
     <% end %>
  <% end %>

  <br>
    <%= @article.title %>
  <br>
    <%= @article.body %>
  <br>
    <% @article_tags.each do |tag| %>
      <%= link_to tag.tag_name, tag_articles_path(tag_id: tag.id) %>
    <% end %>
    <!--特定の投稿に対して紐付けられたタグ-->
  <br>
  <%= @article.created_at.strftime('%Y/%m/%d') %>

  <% if @article.user == current_user %>
    <%= link_to "削除",article_path(@article), method: :delete %>
    <%= link_to "編集", edit_article_path(@article) %>
  <% end %>

  <!-- いいね機能 -->
  <% if @article.liked_by?(current_user) %>
    <p>
      <%= link_to article_likes_path(@article), method: :delete do %>
        ❤️いいね!  <%= @article.likes.count %>
      <% end %>
    </p>
  <% else %>
    <p>
      <%= link_to article_likes_path(@article), method: :post do %>
        ❤️いいね!  <%= @article.likes.count %>
      <% end %>
    </p>
  <% end %>
  
  <% @article.article_comments.each do |article_comment| %>
    <%= article_comment.user.name %>
    <%= article_comment.created_at.strftime('%Y/%m/%d') %><%= article_comment.comment %>
    
    <% if article_comment.user == current_user %>
      <%= link_to "削除", article_article_comments_path(article_comment.article, article_comment), method: :delete %>
    <% end %>
  <% end %>

  <%= form_with(model:[@article, @article_comment], local: true) do |f| %>
    <%= f.text_area :comment, rows:'5',placeholder: "コメントをここに" %>
    <%= f.submit "送信する" %>
  <% end %>
  
  <%= link_to "戻る", articles_path %>
</div>

</div>
</div>

</section>

</center>